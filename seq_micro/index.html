
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jeremyfix.github.io/Architecture/seq_micro/">
      
      
        <link rel="prev" href="../seq_man/">
      
      
        <link rel="next" href="../routines/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Séquence micro-programmé (TP 2) - Architecture des ordinateurs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue-grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sequence-micro-programme-tp-2" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href=".." title="Architecture des ordinateurs" class="md-header__button md-logo" aria-label="Architecture des ordinateurs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Architecture des ordinateurs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Séquence micro-programmé (TP 2)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue-grey"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jeremyfix/architecture" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Architecture des ordinateurs" class="md-nav__button md-logo" aria-label="Architecture des ordinateurs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Architecture des ordinateurs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jeremyfix/architecture" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../seq_man/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Séquenceur manuel (TP 1)
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Séquence micro-programmé (TP 2)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Séquence micro-programmé (TP 2)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#presentation-du-chemin-de-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      Présentation du chemin de données
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Présentation du chemin de données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memoire-ram" class="md-nav__link">
    <span class="md-ellipsis">
      Mémoire RAM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adressage-des-afficheurs-7-segments" class="md-nav__link">
    <span class="md-ellipsis">
      Adressage des afficheurs 7 segments
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#unite-arithmetique-et-logique" class="md-nav__link">
    <span class="md-ellipsis">
      Unité Arithmétique et Logique
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registres-doperandes-et-program-counter" class="md-nav__link">
    <span class="md-ellipsis">
      Registres d'opérandes et Program Counter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sequence-microprogramme" class="md-nav__link">
    <span class="md-ellipsis">
      Séquence microprogrammé
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#travail-a-realiser-programmation-des-micro-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Travail à réaliser : programmation des micro-instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#travail-a-realiser-calculer-avec-votre-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Travail à réaliser : calculer avec votre architecture
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../routines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pile et appel de routines (TP 3)
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../irq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interruptions (TP 4)
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ordonnanceur/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Programmation assembleur et ordonnancement (TP 5)
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../spaceinvaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bonus: place aux jeux
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div><h1 id="sequence-micro-programme-tp-2">Séquence micro-programmé (TP 2)</h1>
<h2 id="introduction">Introduction</h2>
<p>Le but de ce TL est de réaliser un séquenceur micro-programmé pour piloter notre architecture représentée ci-dessous. Nous allons voir qu'un nouveau composant est introduit, une ROM, et votre travail consiste alors à écrire le micro-code de quelques instructions dans cette ROM. Plusieurs programmes vous sont fournis pour tester votre réalisation et vous aurez également à écrire vos propres programmes en code machine. Lancez logisim et chargez l'architecture <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/archi_sequenceur.circ">archi_sequenceur.circ</a> ainsi que le fichier <a href="../assets/csmetz.jar">csmetz.jar</a> à placer dans le même répertoire que <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/archi_sequenceur.circ">archi_sequenceur.circ</a>. Lisez ensuite la présentation ci-dessous avec l'architecture sous les yeux.</p>
<p><a class="glightbox" href="../assets/archi_sequenceur.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Architecture avec séquenceur micro-programmé" src="../assets/archi_sequenceur.png"></a></p>
<p>La mémoire RAM contient des mots de 16 bits et est adressable sur 16 bits et a donc une capacité de 128 Ko. Les opérandes et les adresses sont codées sur 16 bits. Les instructions sont codées sur un ou deux mots de 16 bits : le premier mot contient le code de l'opération et l'éventuel mot suivant contient l'opérande. Le code de l'opération est codé dans les 8 bits de poids fort d'un mot. Ce qui se résumé sur le tableau ci-dessous donnant la sémantique des bits d'un ou deux mots de 16 bits.</p>
<table class="codeop">
      <thead>
        <tr><th>15</th><th>14</th><th>13</th><th>12</th><th>11</th><th>10</th><th> 9</th><th> 8</th><th> 7</th><th> 6</th><th> 5</th><th> 4</th><th> 3</th><th> 2</th><th> 1</th><th> 0</th></tr>
      </thead>
      <tr><td colspan="8">Code de l'opération</td><td colspan="8"> -- bits inutilisés -- </td></tr>
</table>
<table class="codeop">
      <thead>
        <tr><th>15</th><th>14</th><th>13</th><th>12</th><th>11</th><th>10</th><th> 9</th><th> 8</th><th> 7</th><th> 6</th><th> 5</th><th> 4</th><th> 3</th><th> 2</th><th> 1</th><th> 0</th></tr>
      </thead>
      <tr><td colspan="16">Opérande (optionelle)</td></tr>
</table>

<p>Les instructions à disposition sont listées dans la table ci-dessous :</p>
<table>
<thead>
<tr>
<th>Code opération (8 bits)</th>
<th>Nom de l'opération</th>
<th>Nombre de mots</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0c</td>
<td>END</td>
<td>1</td>
<td>Fin de programme</td>
</tr>
<tr>
<td>0x10</td>
<td>LDAi</td>
<td>2</td>
<td>Charge la valeur de l'opérande dans le registre A <br> <ins class="critic">[A := operande]</ins></td>
</tr>
<tr>
<td>0x14</td>
<td>LDAd</td>
<td>2</td>
<td>Charge la valeur dans la RAM pointée par l'opérande dans le registre A. <br><ins class="critic">[A := Mem[opérande]]</ins></td>
</tr>
<tr>
<td>0x18</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>0x1c</td>
<td>STA</td>
<td>2</td>
<td>Sauvegarde en mémoire la valeur du registre A à l'adresse donnée par l'opérande. <br><ins class="critic">[Mem[opérande] := A]</ins></td>
</tr>
<tr>
<td>0x20</td>
<td>LDBi</td>
<td>2</td>
<td>Charge la valeur de l'opérande dans le registre B <br><ins class="critic">[B := operande]</ins></td>
</tr>
<tr>
<td>0x24</td>
<td>LDBd</td>
<td>2</td>
<td>Charge la valeur dans la RAM pointée par l'opérande dans le registre B. <br><ins class="critic">[B := Mem[opérande]]</ins></td>
</tr>
<tr>
<td>0x28</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>0x2c</td>
<td>STB</td>
<td>2</td>
<td>Sauvegarde en mémoire la valeur du registre B à l'adresse donnée par l'opérande. <br><ins class="critic">[Mem[opérande] := B]</ins></td>
</tr>
<tr>
<td>0x30</td>
<td>ADDA</td>
<td>1</td>
<td>Ajoute le contenu des registres A et B et mémorise le résultat dans le registre A. <br><ins class="critic">[A := A + B]</ins></td>
</tr>
<tr>
<td>0x34</td>
<td>ADDB</td>
<td>1</td>
<td>Ajoute le contenu des registres A et B et mémorise le résultat dans le registre B. <br><ins class="critic">[B := A + B]</ins></td>
</tr>
<tr>
<td>0x38</td>
<td>SUBA</td>
<td>1</td>
<td>Soutstrait le contenu des registres A et B et mémorise le résultat dans le registre A. <br><ins class="critic">[A := A - B]</ins></td>
</tr>
<tr>
<td>0x3c</td>
<td>SUBB</td>
<td>1</td>
<td>Soutstrait le contenu des registres A et B et mémorise le résultat dans le registre B. <br><ins class="critic">[B := A - B]</ins></td>
</tr>
<tr>
<td>0x40</td>
<td>MULA</td>
<td>1</td>
<td>Multiplie le contenu des registres A et B et mémorise le résultat dans le registre A. <br><ins class="critic">[A := A x B]</ins></td>
</tr>
<tr>
<td>0x44</td>
<td>MULB</td>
<td>1</td>
<td>Multiplie le contenu des registres A et B et mémorise le résultat dans le registre B. <br><ins class="critic">[B := A x B]</ins></td>
</tr>
<tr>
<td>0x48</td>
<td>DIVA</td>
<td>1</td>
<td>Divise le contenu du registre A par deux et mémorise le résultat dans A. <br><ins class="critic">[A := A / 2]</ins></td>
</tr>
<tr>
<td>0x4c</td>
<td>-</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>0x50</td>
<td>ANDA</td>
<td>1</td>
<td>Calcule un ET logique entre le contenu des registres A et B et mémorise le résultat dans A. <br><ins class="critic">[A := A &amp; B]</ins></td>
</tr>
<tr>
<td>0x54</td>
<td>ANDB</td>
<td>1</td>
<td>Calcule un ET logique entre le contenu des registres A et B et mémorise le résultat dans B. <br><ins class="critic">[B := A &amp; B]</ins></td>
</tr>
<tr>
<td>0x58</td>
<td>ORA</td>
<td>1</td>
<td>Calcule un OU logique entre le contenu des registres A et B et mémorise le résultat dans A. <br><ins class="critic">[A := A</ins></td>
</tr>
<tr>
<td>0x5c</td>
<td>ORB</td>
<td>1</td>
<td>Calcule un OU logique entre le contenu des registres A et B et mémorise le résultat dans B. <br><ins class="critic">[B := A</ins></td>
</tr>
<tr>
<td>0x60</td>
<td>NOTA</td>
<td>1</td>
<td>Mémorise dans A la négation de A. <br><ins class="critic">[A := !A]</ins></td>
</tr>
<tr>
<td>0x64</td>
<td>NOTB</td>
<td>1</td>
<td>Mémorise dans B la négation de B. <br><ins class="critic">[B := !B]</ins></td>
</tr>
<tr>
<td>0x68</td>
<td>-</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>0x6c</td>
<td>-</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>0x70</td>
<td>JMP</td>
<td>2</td>
<td>Saute inconditionnellement à l'adresse donnée par l'opérande. <br><ins class="critic">[PC := operande]</ins></td>
</tr>
<tr>
<td>0x74</td>
<td>JZA</td>
<td>2</td>
<td>Saute à l'adresse donnée par l'opérande si le contenu du registre A est nul. <br><ins class="critic">[PC := operande si A=0]</ins></td>
</tr>
<tr>
<td>0x78</td>
<td>JZB</td>
<td>2</td>
<td>Saute à l'adresse donnée par l'opérande si le contenu du registre B est nul. <br><ins class="critic">[PC := operande si B=0]</ins></td>
</tr>
<tr>
<td>0x7c</td>
<td>-</td>
<td>-</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="presentation-du-chemin-de-donnees">Présentation du chemin de données</h2>
<p>Le chemin de données est constitué de différents éléments que je vous propose de détailler.</p>
<h3 id="memoire-ram">Mémoire RAM</h3>
<p>La mémoire contient les instructions et les données du programme à exécuter. Elle est adressable par le registre RADM (Registre d'Adresse Mémoire); Pour lire la mémoire, il faut d'abord placer l'adresse du mot mémoire à lire dans le registre d'adresse mémoire (RADM). Pour cela, il faut placer l'adresse sur le bus S, activer le registre d'adresse mémoire <code>SetRADM=1</code> et activer un front montant d'horloge. En mettant la mémoire en lecture <code>ReadMem=1</code>, le mot mémoire à l'adresse contenue dans le registre RADM est immédiatement disponible sur la sortie.</p>
<p><a class="glightbox" href="../assets/RAM.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Le composant RAM" src="../assets/RAM.png" width="40%"></a></p>
<p>Pour modifier le contenu de la mémoire, il faut d'abord mettre dans le registre d'adresse mémoire (RADM) l'adresse à laquelle l'information doit être stockée. Ensuite, il faut placer l'information à stocker sur le bus S, mettre la mémoire en mode écriture <ins class="critic">SetMem=1</ins> et activer un front montant d'horloge. Le mot disponible sur l'entrée D sera alors sauvegardée à l'adresse contenue dans le registre RADM au prochain front montant d'horloge. </p>
<h2 id="adressage-des-afficheurs-7-segments">Adressage des afficheurs 7 segments</h2>
<p><a class="glightbox" href="../assets/7segments.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Un afficheur 7 segments" src="../assets/7segments.png" width="60%"></a></p>
<p>L'utilisation des afficheurs 7 segments se fait en adressant la mémoire à des adresses particulières. Les adresses, sur 16 bits, inférieures strict à 0x1000 adressent la RAM; Les trois afficheurs ont respectivement les adresses <ins class="critic">0x1000</ins>, <ins class="critic">0x1001</ins> et <ins class="critic">0x1002</ins>. Pour afficher une valeur sur le premier afficheur, il faut placer l'adresse 0x1000 dans le registre RADM, puis faire comme si on sauvegardait une valeur en mémoire : placer la valeur sur le bus S, mettre la mémoire en écriture (SetMem) et déclencher un front montant d'horloge.</p>
<p>Le composant combinatoire ToBCD (Binaire Codé Décimal) assure la traduction d'un entier codé en binaire sur 16 bits en son codage BCD sur 20 bits pour ensuite afficher chacun des 5 chiffres sur un afficheur 7 segments. Pour information, ce composant peut implémenter l'algorithme du <a href="https://fr.wikipedia.org/wiki/Double_dabble">double dabble</a>.</p>
<h2 id="unite-arithmetique-et-logique">Unité Arithmétique et Logique</h2>
<p>L'unité arithmétique et logique reçoit ses opérandes des bus A et B. Son opération est définie par l'état de l'entrée <ins class="critic">Code_UAL</ins>. L'UAL est un circuit combinatoire donc lorsque le code opération est définie, la sortie est "immédiatement" disponible (en réalité, modulo le temps de transit des signaux dans l'UAL). L'UAL comporte également 3 indicateurs Z, C, V:</p>
<ul>
<li>Z : indicateur de résultat nul, <ins class="critic">Z=1 si S=0</ins></li>
<li>C : indicateur de retenue, C=1 si une retenue apparaît lors du calcul de S</li>
<li>V : indicateur de débordement, V=1 si le calcul de S produit un débordement</li>
</ul>
<p><a class="glightbox" href="../assets/UAL.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="L'Unité Arithmétique et Logique" src="../assets/UAL.png" width="40%"></a></p>
<p>L'UAL fournit 11 opérations décrites dans la table ci-dessous</p>
<table>
<thead>
<tr>
<th>Code UAL (4 bits)</th>
<th>Opération</th>
</tr>
</thead>
<tbody>
<tr>
<td>0000</td>
<td>S = A</td>
</tr>
<tr>
<td>0001</td>
<td>S = B</td>
</tr>
<tr>
<td>0010</td>
<td>S = A ET B</td>
</tr>
<tr>
<td>0011</td>
<td>S = A OU B</td>
</tr>
<tr>
<td>0100</td>
<td>S = non(A)</td>
</tr>
<tr>
<td>0101</td>
<td>S = non(B)</td>
</tr>
<tr>
<td>0110</td>
<td>S = A + B</td>
</tr>
<tr>
<td>0111</td>
<td>S = A - B</td>
</tr>
<tr>
<td>1000</td>
<td>S = A + 1</td>
</tr>
<tr>
<td>1001</td>
<td>S = A - 1</td>
</tr>
<tr>
<td>1010</td>
<td>S = A x B</td>
</tr>
<tr>
<td>1011</td>
<td>S = A &gt;&gt; 1</td>
</tr>
</tbody>
</table>
<h2 id="registres-doperandes-et-program-counter">Registres d'opérandes et Program Counter</h2>
<p>Les registres A, B et program counter sont accessibles en lecture et en écriture. Pour écrire dans ces registres, il suffit de placer une valeur sur le bus S, de les activer <ins class="critic">SetA, SetB, SetPC</ins> et de déclencher un front montant d'horloge. Pour lire les données, il suffit d'activer les portes de sorties, <ins class="critic">ReadA, ReadB, ReadPC</ins>. Attention, les registres A et PC mettent leur sortie sur le bus A mais le registre B sort sur le bus B.</p>
<p><a class="glightbox" href="../assets/registres.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Les registres A, B, et PC" src="../assets/registres.png" width="40%"></a></p>
<h2 id="sequence-microprogramme">Séquence microprogrammé</h2>
<p>Le séquenceur microprogrammé reçoit en entrée le code de l'instruction sur 8 bits (les 8 bits du poids fort du mot mémoire). Programmer le séquenceur consiste à définir la séquence des signaux (micro-instructions) pilotant le chemin de données pour chacune des instructions. La code de l'instruction (e.g. 0x10 pour LDAi) adresse directement la ROM de telle sorte que la séquence de micro-instructions pour l'instruction LDAi commence à l'adresse 0x10 de la ROM. Comme vous pouvez le remarquer, entre chaque code instruction, il y a un offset de 4 mots, ce qui veut dire que vous devez coder chaque instruction par une séquence d'au plus 4 micro-instructions. Pour remplir la ROM, il suffit de faire un clic droit sur la ROM et d'aller dans le menu "Edit Content". Attention: dans la version de logisim que nous utilisons le copier/coller est buggé; le contenu collé est malheureusement toujours collé en début de mémoire. Vous avez la possibilité d'éditer le fichier mémoire avec un éditeur de texte et de charger son contenu ensuite dans la ROM (clic droit sur la ROM, "Load image"). On va revenir sur ce point dans la partie "Conseil de mise en oeuvre" à la fin du sujet.</p>
<p>La disposition des instructions dans la ROM vous est imposée.</p>
<ul>
<li>A l'adresse 0x00, vous devez sauter à l'adresse 0x08 qui contient les micro-instructions pour les phases de Fetch/Decode. Nous utiliserons dans un sujet ultérieur cette zone mémoire différemment, pour y placer les interruptions,</li>
<li>A l'adresse 0x08 se trouvent les micro-instructions de la phase de Fetch/Decode,</li>
<li>A l'adresse 0x0c se trouvent les micro-instructions pour l'instruction END,</li>
<li>A l'adresse 0x10 se trouvent les micro-instructions pour l'instruction LDAi, </li>
<li>puis à l'adrese 0x14 pour l'instruction LDAd, </li>
<li>etc..</li>
</ul>
<p><a class="glightbox" href="../assets/sequenceur.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Le séquenceur micro-programmé" src="../assets/sequenceur.png" width="80%"></a></p>
<p>Une micro-instruction est un mot sur 32 bits, les 24 premiers bits pilotant le chemin de données, les 8 derniers bits codant une adresse essentiellement utilisée pour les branchements. Schématiquement, une micro-instruction a donc le format suivant : </p>
<p><a class="glightbox" href="../assets/struct_instruction.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Structure d'une micro-instruction" src="../assets/struct_instruction.png"></a></p>
<p>Il nous reste à expliquer le rôle du champ sur 3 bits CodeMCount et de l'adresse sur 8 bits Adr. Les 3 bits CodeMCount sont combinés avec la sortie Z de l'UAL pour piloter le multiplexeur en entrée du registre d'adresse de micro-instruction MicroPC. Notons SMux la sortie du multiplexeur, le composant qui interface CodeMCount, Z et le multiplexeur agit ainsi: </p>
<ul>
<li>Si <ins class="critic">CodeMCount=0b000</ins>, alors <ins class="critic">SMux=MicroPC+1</ins></li>
<li>Si <ins class="critic">CodeMCount=0b001</ins>, alors <ins class="critic">SMux=@Adr</ins></li>
<li>Si <ins class="critic">CodeMCount=0b010</ins>, alors <ins class="critic">SMux=InstCode</ins></li>
<li>Si <ins class="critic">CodeMCount=0b011</ins> et <ins class="critic">Z=0</ins>, alors <ins class="critic">SMux=MicroPC+1</ins></li>
<li>Si <ins class="critic">CodeMCount=0b011</ins> et <ins class="critic">Z=1</ins>, alors <ins class="critic">SMux=@Adr</ins></li>
</ul>
<p>Le registre micro PC est au séquenceur en ROM ce que le program counter est au programme en RAM : il permet de l'adresser et de savoir quelle micro-instruction exécuter. Pour certaines instructions (e.g. JZA), il est nécessaire de sauter plusieurs mots dans la ROM. Pour simplifier le nombre de composants, il a été choisi de préciser dans la micro-instruction l'adresse du saut:</p>
<ul>
<li>pour ce TP, la première micro-instruction de la ROM, i.e. à l'adresse 0x00, doit faire sauter le micro PC à l'adresse des microinstructions de fetch/decode : <ins class="critic">CodeMCount=0b001, @Adr=0x08 soit ROM[0x00]=0x00800008</ins></li>
<li>il ne faudra pas oublier de retourner à l'adresse 0x00 à la fin d'une séquence de micro-instruction</li>
<li>pour les sauts conditionnels JZA, JZB, on devra utiliser le champ @Adr de la micro-instruction si le test est vrai</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Prenons par exemple l'instruction de chargement immédiat dans le registre A (LDAi, code:0x10). Pour exécuter cette instruction, il faut:</p>
<ul>
<li>Charger dans le registre d'adresse mémoire le contenu du registre PC (<ins class="critic">ReadPC=1, Code UAL=0000</ins> qui correspond à l'opération S=A, <ins class="critic">SetRADM=1</ins>). Le code de la microinstruction associée est donc <ins class="critic">0x00000c00</ins></li>
<li>Mettre la mémoire en mode lecture (<ins class="critic">ReadMem = 1</ins>), diriger l'entrée B vers la sortie S (<ins class="critic">Code UAL=0001</ins>) et activer le registre A en écriture (<ins class="critic">SetA = 1</ins>). Le code de la microinstruction associée est donc <ins class="critic">0x00084100</ins></li>
<li>Enfin, il faut incrémenter le program counter (<ins class="critic">ReadPC=1, CodeUAL=1000, SetPC=1</ins>) et mettre dans le registre micro PC l'adresse du début de la ROM (<ins class="critic">Adr=0x00, CodeMCount=001</ins>). Le code de la microinstruction associée est donc <ins class="critic">0x00c01800</ins></li>
</ul>
<p>L'instruction LDA immédiat nécessite donc 3 micro-instructions : <ins class="critic">0x00000c00, 0x00084100, 0x00c01800</ins>.</p>
</div>
<h2 id="travail-a-realiser-programmation-des-micro-instructions">Travail à réaliser : programmation des micro-instructions</h2>
<p>On vous demande d'écrire le microcode dans la ROM pour chacune des 23 instructions présentées un peu plus haut. La méthode consiste à prendre les instructions les unes après les autres et à écrire la séquence de codes hexadécimaux permettant de réaliser l'instruction. Ces codes hexadécimaux permettent de configurer le chemin de données. Les codes d'instructions, d'UAL, ... sont listés précédemment et également synthésisés dans la <a href="../assets/reference_card.pdf">carte de référence</a>.</p>
<p>Pour faciliter votre travail de calcul des micro-instructions, je vous propose
d'utiliser <button id="showTableBtn" class="md-button md-button--primary">la table de génération de micro-instructions</button></p>
<script>
document.getElementById('showTableBtn').onclick = function() {
    var dataId = 0;
    var dataSp = 0;
    var dataINT = 0;
    console.log("dataid from main: " + dataId);
    openTable(dataId, dataSp, dataINT);
};
</script>

<p>Comme expliqué dans la partie ci-dessous "Conseils de mise en oeuvre", vous partirez du fichier mémoire <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Microcodes/microcode_seq.rom">microcode_seq.rom</a>. Vous remarquerez que la première micro-instruction est déjà mentionnée, elle permet de sauter dans la ROM à l'adresse des micro-instructions du Fetch/Decode. Les micro-instructions pour l'instruction END sont également déjà mentionnées. Pour pouvoir tester les séquences de micro-instruction que vous allez définir, vous trouverez ci-dessous quelques programmes à charger dans la RAM. Il faudra toujours cliquer sur le bouton "Clear" en haut du circuit pour remettre les registres dans leur état initial avant de tester un programme.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Je vous propose de coder les instructions dans l'ordre suivant :</p>
<ul>
<li>renseignez les micro-instructions pour la phase de Fetch/Decode en commençant à l'adresse 0x08</li>
<li>renseignez les micro-instructions pour les instructions LDAi et STA et testez votre architecture avec le programme <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Progs/LDAiSTA.mem">LDAiSTA.mem</a>. Vous devriez voir 2025 sur le premier afficheur (pourquoi?),</li>
<li>renseignez les micro-instructions pour l'instructions LDAd et testez votre architecture avec le programme <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Progs/LDadSTA.mem">LDAdSTA.mem</a>. Vous devriez voir 2025 sur le premier afficheur (pourquoi?),</li>
<li>renseignez les micro-instructions pour les instructions LDBi, LDBd, STB, ADDA et testez votre architecture en écrivant vous même un fichier mémoire de test,</li>
<li>renseignez les micro-instructions pour les instructions arithmétiques SUB, MUL, .. et logiques AND, OR, .. et adaptez les codes donnés précédemment pour tester votre architecture,</li>
<li>renseignez les micro-instructions pour le saut inconditionnel JMP et testez votre architecture avec le programme <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Progs/JMP.mem">JMP.mem</a>. Que vous attendez vous à voir ?</li>
<li>renseignez les micro-instructions pour le saut conditionnel JZA et JZB et testez votre architecture avec le programme <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Progs/JZ.mem">JZ.mem</a>,</li>
<li>renseignez les micro-instructions pour l'instruction DIVA et testez votre architecture avec le programme <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Progs/DIV.mem">DIV.mem</a>.</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Conseil de mise en oeuvre</strong></p>
<p>Vous avez la possibilité de modifier le contenu des RAM et ROM depuis logisim. Néanmoins, je vous conseille de procéder différemment. Vous avez en effet la possibilité de charger la mémoire à partir d'un fichier. Je vous propose donc de télécharger le fichier <a href="https://raw.githubusercontent.com/jeremyfix/Architecture/refs/heads/main/TP-Evolution/Microcodes/microcode_seq.rom">microcode_seq.rom</a>, de le modifier avec un éditeur de texte (gedit ou emacs par example) et de le charger ensuite en ROM. Le texte commençant par "#" sont des commentaires pour vous aider à vous repérer dans la ROM. </p>
</div>
<h2 id="travail-a-realiser-calculer-avec-votre-architecture">Travail à réaliser : calculer avec votre architecture</h2>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Calculez la suite de syracuse avec votre architecture en écrivant le code machine adéquat.</p>
<div class="arithmatex">\[\begin{eqnarray}
u(0) &amp;=&amp; 127\\
u(n+1) &amp;=&amp; \begin{cases} \frac{u(n)}{2} &amp; \text{si } u(n)\text{ pair} \\ 3 u(n) + 1 &amp; \text{sinon} \end{cases} 
\end{eqnarray}\]</div>
<p>Affichez les valeurs sur les afficheurs 7 ségments (voir par exemple <a href="http://www.dcode.fr/conjecture-syracuse">ce site</a> pour vérifier les valeurs).... </p>
<p>4, 2, 1, 4, 2, 1, mais <a href="https://fr.wikipedia.org/wiki/Conjecture_de_Syracuse">pourquoi ?</a> </p>
<div class="language-text highlight"><pre><span></span><code>"Les mathématiques ne sont pas encore prêtes pour de tels problèmes [P. Erdos]"
</code></pre></div>
</div></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - Jérémy Fix –

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
      
        <script src="../js/seq_decode.js"></script>
      
        <script src="../js/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>